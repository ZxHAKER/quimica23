<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ACTIVITY | ESTRUCTURAS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00d2ff;
            --accent-2: #3a7bd5;
            --danger: #ff4b5c;
            --success: #00e676;
            --bg: #0b0e14;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; transition: all 0.2s ease; }

        body {
            background: var(--bg);
            background-image: radial-gradient(circle at 0% 0%, rgba(0, 210, 255, 0.1) 0%, transparent 40%);
            color: #fff; font-family: 'Inter', sans-serif;
            margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: flex-start;
            padding: 10px;
        }

        /* --- CONTENEDOR PRINCIPAL RESPONSIVO --- */
        .app-shell {
            width: 100%; max-width: 1200px;
            min-height: 90vh;
            background: rgba(15, 20, 28, 0.9); backdrop-filter: blur(20px);
            border: 1px solid var(--border); border-radius: 30px;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 40px 100px rgba(0,0,0,0.5);
        }

        header {
            padding: 15px 25px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.3);
            flex-wrap: wrap; gap: 10px;
        }

        .logo { font-weight: 800; font-size: 1.1rem; color: var(--accent); text-transform: uppercase; }

        .screen { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .hidden { display: none !important; }

        /* --- GRID DE MEN√ö (VERTICAL EN M√ìVIL) --- */
        .modes-container { 
            display: grid; grid-template-columns: repeat(3, 1fr); 
            gap: 20px; width: 100%; margin-top: 20px;
        }

        .mode-card { 
            background: var(--glass); border: 1px solid var(--border); 
            padding: 30px 15px; border-radius: 20px; cursor: pointer; text-align: center;
        }
        .mode-card h3 { font-size: 1.2rem; margin: 0 0 10px 0; color: var(--accent); }
        .mode-card p { font-size: 0.85rem; color: #94a3b8; margin: 0; }

        /* --- LAYOUT DE JUEGO --- */
        .game-grid { 
            display: flex; flex-direction: row; 
            gap: 20px; width: 100%;
        }
        
        .canvas-container { 
            flex: 1.5; background: #000; border-radius: 20px; 
            display: flex; align-items: center; justify-content: center; min-height: 300px;
            border: 1px solid var(--border);
        }

        .side-ui { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        
        .input-premium { 
            background: #1a1f26; border: 2px solid var(--border); 
            padding: 18px; border-radius: 15px; color: #fff; font-size: 1.1rem; 
            width: 100%; text-align: center;
        }

        .btn-main { 
            padding: 18px; border-radius: 15px; border: none; font-weight: 800; 
            cursor: pointer; background: linear-gradient(90deg, var(--accent-2), var(--accent)); color: white;
        }

        .btn-option { background: var(--glass); border: 1px solid var(--border); color: white; padding: 10px 15px; border-radius: 10px; }

        /* --- MEDIA QUERIES CR√çTICAS PARA M√ìVIL --- */
        @media (max-width: 850px) {
            body { align-items: flex-start; padding: 5px; }
            .app-shell { border-radius: 15px; min-height: 98vh; height: auto; }
            
            .modes-container { grid-template-columns: 1fr; } /* Men√∫ en lista vertical */
            
            .game-grid { flex-direction: column; } /* Estructura arriba, controles abajo */
            .canvas-container { min-height: 250px; flex: none; }
            
            h1 { font-size: 1.8rem !important; margin-bottom: 20px !important; }
            .logo { font-size: 0.9rem; }
            
            header { padding: 10px; justify-content: space-around; }
            .badge-hud { font-size: 0.7rem; padding: 5px 10px; }
        }

        .badge-hud { background: #000; padding: 8px 15px; border-radius: 50px; border: 1px solid var(--border); font-family: 'Fira Code'; }
    </style>
</head>
<body>

    <div class="app-shell">
        <header>
            <div class="logo">QUIMICA<span>ACTIVIDAD</span></div>
            <div id="game-hud" style="display:none; gap:8px;">
                <div class="badge-hud" style="color:var(--danger)">‚ù§Ô∏è <span id="v-val">3</span></div>
                <div class="badge-hud" style="color:var(--success)">‚≠ê <span id="s-val">0</span></div>
                <div class="badge-hud" style="color:var(--accent)"><span id="l-val">1/20</span></div>
            </div>
            <button class="btn-option" style="font-size: 0.6rem;" onclick="location.reload()">REINICIAR</button>
        </header>

        <section id="sc-menu" class="screen">
            <h1 style="font-size: 2.5rem; margin: 0; font-weight: 800; color:var(--accent); text-align: center;">¬°A PRACTICAR!</h1>
            <p style="color:#94a3b8; font-size: 0.8rem; text-align: center; margin-bottom: 20px;">Grace, Mariana, Marco, Samuel</p>
            
            <div class="modes-container">
                <div class="mode-card" onclick="Core.start('nomen')">
                    <h3>NOMENCLATURA</h3>
                    <p>Alcanos y Alquinos.</p>
                </div>
                <div class="mode-card" onclick="Core.start('tipos')">
                    <h3>CARBONOS</h3>
                    <p>Primarios a Cuaternarios.</p>
                </div>
                <div class="mode-card" onclick="Core.start('iso')">
                    <h3>ISOMER√çA</h3>
                    <p>Estructuras.</p>
                </div>
            </div>
        </section>

        <section id="sc-game" class="screen hidden">
            <div class="game-grid">
                <div class="canvas-container" id="canvas"></div>
                <div class="side-ui">
                    <h2 id="quest-title" style="margin:0; font-weight: 600; font-size: 1.1rem; text-align: center;">Analiza la estructura</h2>
                    <div id="ui-input-box">
                        <input type="text" id="ans-in" class="input-premium" placeholder="Escribe aqu√≠..." autocomplete="off">
                        <button class="btn-main" style="width:100%; margin-top:10px" onclick="Core.check()">VALIDAR</button>
                    </div>
                    <div id="ui-options-box" class="hidden" style="display:grid; grid-template-columns: 1fr; gap:8px"></div>
                    <p id="hint-link" style="text-align:center; color:var(--accent); cursor:pointer; font-size:0.8rem" onclick="Core.hint()">üí° PISTA (-20 PTS)</p>
                </div>
            </div>
        </section>

        <section id="sc-end" class="screen hidden">
            <h1 id="end-title" style="font-size: 2rem; text-align: center;">RESULTADO</h1>
            <div id="feedback" style="background:var(--glass); padding:20px; border-radius:15px; width: 100%; font-size:0.9rem; text-align: center;"></div>
            <div id="final-score" style="font-size: 4rem; font-weight: 800; color: var(--accent); margin: 15px 0;">0</div>
            <button class="btn-main" style="width:200px" onclick="location.reload()">INICIO</button>
        </section>
    </div>

    <script>
        // Los datos y la l√≥gica (Core) se mantienen intactos para no romper la funcionalidad.
        const DB = {
            nomen: [
                { ans: ["propano"], svg: "M100,150 L150,110 L200,150", hint: "3 carbonos." },
                { ans: ["butano"], svg: "M80,150 L130,110 L180,150 L230,110", hint: "4 carbonos." },
                { ans: ["2-metilpropano"], svg: "M100,150 L150,110 L200,150 M150,110 L150,60", hint: "Rama en el C2." },
                { ans: ["pentano"], svg: "M50,150 L100,110 L150,150 L200,110 L250,150", hint: "5 carbonos." },
                { ans: ["2,2-dimetilpropano"], svg: "M120,150 L170,110 L220,150 M170,110 L170,60 M170,110 L135,85", hint: "Dos ramas en el mismo C." },
                { ans: ["3-metilpentano"], svg: "M50,150 L100,110 L150,150 L200,110 L250,150 M150,150 L150,200", hint: "Centro de 5 carbonos." },
                { ans: ["hexano"], svg: "M50,150 L100,110 L150,150 L200,110 L250,150 L300,110", hint: "6 carbonos." },
                { ans: ["2,3-dimetilbutano"], svg: "M100,150 L150,110 L200,150 L250,110 M150,110 L150,60 M200,150 L200,200", hint: "Dos metilos vecinos." },
                { ans: ["2-metilpentano"], svg: "M50,150 L100,110 L150,150 L200,110 L250,150 M100,110 L100,60", hint: "Rama cerca del inicio." },
                { ans: ["3,3-dimetilpentano"], svg: "M50,150 L100,110 L150,150 L200,110 L250,150 M150,150 L150,100 M150,150 L150,200", hint: "Cruz en el centro." },
                { ans: ["2-butino"], svg: "M100,150 L150,110 L220,110 L270,150", type: "triple", hint: "Triple enlace central." },
                { ans: ["3-octino"], svg: "M30,150 L80,110 L130,150 L200,150 L270,150 L320,110 L370,150 L400,110", type: "triple", hint: "8 carbonos, triple enlace en C3." }
            ],
            tipos: Array.from({length: 20}, (_, i) => ({
                target: [150, 110], 
                ans: i % 4 === 0 ? "Primario" : i % 4 === 1 ? "Secundario" : i % 4 === 2 ? "Terciario" : "Cuaternario",
                svg: "M50,150 L100,110 L150,110 L200,110 L250,150", 
                hint: "Cuenta los vecinos directos."
            })),
            iso: Array.from({length: 20}, (_, i) => ({
                q: i % 2 === 0 ? "¬øRelaci√≥n n-butano e isobutano?" : "¬øIs√≥meros de qu√© tipo son?",
                opts: ["Is√≥meros de Cadena", "Is√≥meros de Posici√≥n", "Is√≥meros de Funci√≥n", "No son is√≥meros"],
                ans: i % 2 === 0 ? "Is√≥meros de Cadena" : "Is√≥meros de Posici√≥n",
                svg: "M100,120 L150,80 L200,120 L250,80 M100,200 L150,160 L200,200 M150,160 L150,220",
                hint: "Observa el esqueleto."
            }))
        };

        const Core = {
            m: '', i: 0, s: 0, v: 3,
            start(mode) {
                this.m = mode; this.i = 0; this.v = 3; this.s = 0;
                document.getElementById('sc-menu').classList.add('hidden');
                document.getElementById('sc-game').classList.remove('hidden');
                document.getElementById('game-hud').style.display = 'flex';
                this.load();
            },
            load() {
                const d = DB[this.m][this.i];
                if(!d || this.i >= 20) return this.end(true);
                const canvas = document.getElementById('canvas');
                canvas.innerHTML = '';
                document.getElementById('ans-in').value = '';
                this.upd();
                const isChoice = (this.m !== 'nomen');
                document.getElementById('ui-input-box').classList.toggle('hidden', isChoice);
                document.getElementById('ui-options-box').classList.toggle('hidden', !isChoice);
                if(this.m === 'iso') {
                    document.getElementById('quest-title').innerText = d.q;
                    this.draw(d);
                    this.renderOptions(d.opts);
                } else if(this.m === 'tipos') {
                    document.getElementById('quest-title').innerText = "¬øGrado del carbono marcado?";
                    this.drawTipos(this.i);
                    this.renderOptions(["Primario", "Secundario", "Terciario", "Cuaternario"]);
                } else {
                    document.getElementById('quest-title').innerText = "Nombre IUPAC:";
                    this.draw(d);
                }
            },
            renderOptions(opts) {
                const box = document.getElementById('ui-options-box');
                box.innerHTML = '';
                opts.forEach(o => {
                    const btn = document.createElement('button');
                    btn.style.padding = "15px";
                    btn.style.background = "rgba(255,255,255,0.05)";
                    btn.style.color = "white";
                    btn.style.border = "1px solid var(--border)";
                    btn.style.borderRadius = "10px";
                    btn.innerText = o;
                    btn.onclick = () => this.validate(o);
                    box.appendChild(btn);
                });
            },
            draw(d) {
                const ns = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(ns, "svg");
                svg.setAttribute("viewBox", "0 0 450 250");
                svg.style.width = "90%";
                const p = document.createElementNS(ns, "path");
                p.setAttribute("d", d.svg); p.setAttribute("stroke", "white");
                p.setAttribute("stroke-width", "6"); p.setAttribute("fill", "none");
                p.setAttribute("stroke-linecap", "round");
                svg.appendChild(p);
                if(d.type === "triple") {
                    const t1 = document.createElementNS(ns, "path");
                    t1.setAttribute("d", "M150,102 L220,102"); t1.setAttribute("stroke", "white"); t1.setAttribute("stroke-width", "2");
                    const t2 = document.createElementNS(ns, "path");
                    t2.setAttribute("d", "M150,118 L220,118"); t2.setAttribute("stroke", "white"); t2.setAttribute("stroke-width", "2");
                    svg.appendChild(t1); svg.appendChild(t2);
                }
                document.getElementById('canvas').appendChild(svg);
            },
            drawTipos(idx) {
                const layouts = [
                    {s:"M100,150 L150,110 L200,150", t:[100,150], a:"Primario"},
                    {s:"M100,150 L150,110 L200,150", t:[150,110], a:"Secundario"},
                    {s:"M100,150 L150,110 L200,150 M150,110 L150,60", t:[150,110], a:"Terciario"},
                    {s:"M100,110 L150,110 L200,110 M150,110 L150,60 M150,110 L150,160", t:[150,110], a:"Cuaternario"}
                ];
                const d = layouts[idx % 4];
                DB.tipos[idx].ans = d.a;
                const ns = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(ns, "svg");
                svg.setAttribute("viewBox", "0 0 400 250"); svg.style.width = "85%";
                const p = document.createElementNS(ns, "path");
                p.setAttribute("d", d.s); p.setAttribute("stroke", "white"); p.setAttribute("stroke-width", "6"); p.setAttribute("fill", "none");
                svg.appendChild(p);
                const c = document.createElementNS(ns, "circle");
                c.setAttribute("cx", d.t[0]); c.setAttribute("cy", d.t[1]); c.setAttribute("r", "12"); c.setAttribute("fill", "var(--accent)");
                svg.appendChild(c);
                document.getElementById('canvas').appendChild(svg);
            },
            check() {
                const user = document.getElementById('ans-in').value.toLowerCase().trim().replace(/-/g,'');
                const corrects = DB.nomen[this.i].ans.map(x => x.toLowerCase().replace(/-/g,''));
                this.validate(corrects.includes(user) ? DB.nomen[this.i].ans[0] : 'err');
            },
            validate(val) {
                const d = DB[this.m][this.i];
                const ok = (this.m === 'nomen') ? val !== 'err' : val === d.ans;
                if(ok) { this.s += 100; this.i++; this.load(); }
                else { this.v--; if(this.v <= 0) this.end(false); this.upd(); }
            },
            hint() { if(this.s >= 20) { this.s -= 20; alert(DB[this.m][this.i].hint); this.upd(); } },
            upd() {
                document.getElementById('v-val').innerText = this.v;
                document.getElementById('s-val').innerText = this.s;
                document.getElementById('l-val').innerText = `${this.i + 1}/20`;
            },
            end(win) {
                document.getElementById('sc-game').classList.add('hidden');
                document.getElementById('sc-end').classList.remove('hidden');
                document.getElementById('feedback').innerText = win ? "¬°Excelente! Has dominado este m√≥dulo." : "Int√©ntalo de nuevo. La qu√≠mica requiere pr√°ctica.";
                document.getElementById('final-score').innerText = this.s;
            }
        };
    </script>
</body>
</html>