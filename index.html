<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ACTIVITY | ESTRUCTURAS </title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00d2ff;
            --accent-2: #3a7bd5;
            --danger: #ff4b5c;
            --success: #00e676;
            --bg: #0b0e14;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; transition: all 0.2s ease; }

        body {
            background: var(--bg);
            background-image: radial-gradient(circle at 0% 0%, rgba(0, 210, 255, 0.1) 0%, transparent 40%);
            color: #fff; font-family: 'Inter', sans-serif;
            margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: flex-start;
            padding: 10px;
        }

        .app-shell {
            width: 100%; max-width: 1200px;
            min-height: 90vh;
            background: rgba(15, 20, 28, 0.9); backdrop-filter: blur(20px);
            border: 1px solid var(--border); border-radius: 30px;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 40px 100px rgba(0,0,0,0.5);
        }

        header {
            padding: 15px 25px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.3);
            flex-wrap: wrap; gap: 10px;
        }

        .logo { font-weight: 800; font-size: 1.1rem; color: var(--accent); text-transform: uppercase; }

        .screen { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .hidden { display: none !important; }

        .modes-container { 
            display: grid; grid-template-columns: repeat(3, 1fr); 
            gap: 20px; width: 100%; margin-top: 20px;
        }

        .mode-card { 
            background: var(--glass); border: 1px solid var(--border); 
            padding: 30px 15px; border-radius: 20px; cursor: pointer; text-align: center;
        }
        .mode-card h3 { font-size: 1.2rem; margin: 0 0 10px 0; color: var(--accent); }
        .mode-card p { font-size: 0.85rem; color: #94a3b8; margin: 0; }

        .game-grid { 
            display: flex; flex-direction: row; 
            gap: 20px; width: 100%;
        }
        
        .canvas-container { 
            flex: 1.5; background: #000; border-radius: 20px; 
            display: flex; align-items: center; justify-content: center; min-height: 350px;
            border: 1px solid var(--border); padding: 10px;
        }

        .side-ui { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        
        .input-premium { 
            background: #1a1f26; border: 2px solid var(--border); 
            padding: 18px; border-radius: 15px; color: #fff; font-size: 1.1rem; 
            width: 100%; text-align: center;
        }

        .btn-main { 
            padding: 18px; border-radius: 15px; border: none; font-weight: 800; 
            cursor: pointer; background: linear-gradient(90deg, var(--accent-2), var(--accent)); color: white;
        }

        .btn-option { background: var(--glass); border: 1px solid var(--border); color: white; padding: 10px 15px; border-radius: 10px; cursor: pointer; }

        /* --- MODAL DE INSTRUCCIONES --- */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content {
            background: #161b22; padding: 30px; border-radius: 25px; border: 1px solid var(--accent);
            max-width: 500px; width: 90%; text-align: left;
        }
        .modal-content h2 { color: var(--accent); margin-top: 0; }
        .modal-content ul { padding-left: 20px; color: #cbd5e1; line-height: 1.6; }

        @media (max-width: 850px) {
            .modes-container { grid-template-columns: 1fr; }
            .game-grid { flex-direction: column; }
            .canvas-container { min-height: 280px; }
        }

        .badge-hud { background: #000; padding: 8px 15px; border-radius: 50px; border: 1px solid var(--border); font-family: 'Fira Code'; }
    </style>
</head>
<body>

    <div id="modal-rules" class="modal hidden">
        <div class="modal-content">
            <h2>üìú Reglas del Juego</h2>
            <ul>
                <li><strong>Nomenclatura:</strong> Escribe el nombre IUPAC completo. Usa guiones para n√∫meros y letras (ej: 2-metilpropano).</li>
                <li><strong>Carbonos:</strong> Identifica si el √°tomo resaltado en azul es Primario, Secundario, Terciario o Cuaternario.</li>
                <li><strong>Isomer√≠a:</strong> Compara las estructuras y elige el tipo de is√≥mero correcto.</li>
                <li><strong>Puntaje:</strong> +100 por acierto. Las pistas cuestan -20 puntos.</li>
                <li><strong>Vidas:</strong> Tienes 3 Vidas. Si fallas una respuesta, pierdes una.</li>
            </ul>
            <button class="btn-main" style="width:100%" onclick="toggleRules()">¬°ENTENDIDO!</button>
        </div>
    </div>

    <div class="app-shell">
        <header>
            <div class="logo">QUIMICA<span>ESTRUCTURAS</span></div>
            <div id="game-hud" style="display:none; gap:8px;">
                <div class="badge-hud" style="color:var(--danger)">‚ù§Ô∏è <span id="v-val">3</span></div>
                <div class="badge-hud" style="color:var(--success)">‚≠ê <span id="s-val">0</span></div>
                <div class="badge-hud" style="color:var(--accent)"><span id="l-val">1/20</span></div>
            </div>
            <div style="display:flex; gap: 5px;">
                <button class="btn-option" style="font-size: 0.6rem;" onclick="toggleRules()">REGLAS</button>
                <button class="btn-option" style="font-size: 0.6rem;" onclick="location.reload()">REINICIAR</button>
            </div>
        </header>

        <section id="sc-menu" class="screen">
            <h1 style="font-size: 2.5rem; margin: 0; font-weight: 800; color:var(--accent); text-align: center;">¬°HORA DE PRACTICAR !</h1>
            <p style="color:#94a3b8; font-size: 0.8rem; text-align: center; margin-bottom: 20px;">Grace Fiallo, Mariana Garzon, Marco Mendoza, Samuel Santoyo.</p>
            
            <div class="modes-container">
                <div class="mode-card" onclick="Core.start('nomen')">
                    <h3>NOMENCLATURA</h3>
                    <p>Identificar la Nomenclatura de las siguientes estrcuturas.</p>
                </div>
                <div class="mode-card" onclick="Core.start('tipos')">
                    <h3>CARBONOS</h3>
                    <p>Identificar los tipos de carbonos.</p>
                </div>
                <div class="mode-card" onclick="Core.start('iso')">
                    <h3>ISOMER√çA</h3>
                    <p>Identificar estructuras complejas </p>
                </div>
            </div>
        </section>

        <section id="sc-game" class="screen hidden">
            <div class="game-grid">
                <div class="canvas-container" id="canvas"></div>
                <div class="side-ui">
                    <h2 id="quest-title" style="margin:0; font-weight: 600; font-size: 1.1rem; text-align: center;">Analiza la estructura</h2>
                    <div id="ui-input-box">
                        <input type="text" id="ans-in" class="input-premium" placeholder="Ej: 3-etil-2-metilhexano" autocomplete="off">
                        <button class="btn-main" style="width:100%; margin-top:10px" onclick="Core.check()">VALIDAR</button>
                    </div>
                    <div id="ui-options-box" class="hidden" style="display:grid; grid-template-columns: 1fr; gap:8px"></div>
                    <p id="hint-link" style="text-align:center; color:var(--accent); cursor:pointer; font-size:0.8rem" onclick="Core.hint()">üí° PISTA (-20 PTS)</p>
                </div>
            </div>
        </section>

        <section id="sc-end" class="screen hidden">
            <h1 id="end-title" style="font-size: 2rem; text-align: center;">RESULTADO</h1>
            <div id="feedback" style="background:var(--glass); padding:20px; border-radius:15px; width: 100%; font-size:0.9rem; text-align: center;"></div>
            <div id="final-score" style="font-size: 4rem; font-weight: 800; color: var(--accent); margin: 15px 0;">0</div>
            <button class="btn-main" style="width:200px" onclick="location.reload()">INICIO</button>
        </section>
    </div>

    <script>
        function toggleRules() {
            document.getElementById('modal-rules').classList.toggle('hidden');
        }

        const DB = {
            nomen: [
                { 
                    ans: ["4-isopropil-5-metil-2-deceno"], 
                    svg: "M20,150 L60,110 L100,110 L140,150 L180,110 L220,150 L260,110 L300,150 L340,110 L380,150 M140,150 L140,190 L110,210 M140,190 L170,210 M180,110 L180,60", 
                    type: "doble", 
                    hint: "Cadena de 10 con doble enlace en C2 e isopropilo en C4." 
                },
                { 
                    ans: ["3-etil-4,5-dimetilheptano"], 
                    svg: "M50,150 L100,110 L150,150 L200,110 L250,150 L300,110 L350,150 M150,150 L150,200 L120,220 M200,110 L200,60 M250,150 L250,200", 
                    hint: "7 carbonos, un etilo y dos metilos." 
                },
                { 
                    ans: ["2,2,4-trimetilpentano"], 
                    svg: "M80,150 L130,110 L180,150 L230,110 L280,150 M130,110 L130,60 M130,110 L90,80 M230,110 L230,60", 
                    hint: "Cadena de 5 con 3 metilos." 
                },
                { 
                    ans: ["3-etil-2,5-dimetilhexano"], 
                    svg: "M50,120 L100,80 L150,120 L200,80 L250,120 L300,80 M100,80 L100,30 M150,120 L150,170 L180,190 M250,120 L250,170", 
                    hint: "Hexano con etilo en el medio." 
                },
                { 
                    ans: ["4-ter-butiloctano"], 
                    svg: "M40,150 L90,110 L140,150 L190,110 L240,150 L290,110 L340,150 L390,110 M190,110 L190,60 M190,60 L160,30 M190,60 L220,30 M190,60 L190,10", 
                    hint: "Rama con forma de cruz en C4." 
                },
                { 
                    ans: ["5-isopropil-2,3-dimetilheptano"], 
                    svg: "M50,150 L100,110 L150,150 L200,110 L250,150 L300,110 L350,150 M100,110 L100,60 M150,150 L150,200 M250,150 L250,200 L220,220 M250,200 L280,220", 
                    hint: "Combina isopropiles y metiles." 
                }
            ],
            tipos: Array.from({length: 20}, (_, i) => ({
                target: [150, 110], 
                ans: i % 4 === 0 ? "Primario" : i % 4 === 1 ? "Secundario" : i % 4 === 2 ? "Terciario" : "Cuaternario",
                svg: "M50,150 L100,110 L150,110 L200,110 L250,150", 
                hint: "Cuenta los carbonos directos."
            })),
            iso: Array.from({length: 20}, (_, i) => ({
                q: i % 2 === 0 ? "¬øRelaci√≥n n-butano e isobutano?" : "¬øIs√≥meros de qu√© tipo son?",
                opts: ["Is√≥meros de Cadena", "Is√≥meros de Posici√≥n", "Is√≥meros de Funci√≥n", "No son is√≥meros"],
                ans: i % 2 === 0 ? "Is√≥meros de Cadena" : "Is√≥meros de Posici√≥n",
                svg: "M100,120 L150,80 L200,120 L250,80 M100,200 L150,160 L200,200 M150,160 L150,220",
                hint: "Observa el esqueleto."
            }))
        };

        const Core = {
            m: '', i: 0, s: 0, v: 3,
            start(mode) {
                this.m = mode; this.i = 0; this.v = 3; this.s = 0;
                document.getElementById('sc-menu').classList.add('hidden');
                document.getElementById('sc-game').classList.remove('hidden');
                document.getElementById('game-hud').style.display = 'flex';
                this.load();
            },
            load() {
                const d = DB[this.m][this.i % DB[this.m].length];
                if(this.i >= 20) return this.end(true);
                const canvas = document.getElementById('canvas');
                canvas.innerHTML = '';
                document.getElementById('ans-in').value = '';
                this.upd();
                const isChoice = (this.m !== 'nomen');
                document.getElementById('ui-input-box').classList.toggle('hidden', isChoice);
                document.getElementById('ui-options-box').classList.toggle('hidden', !isChoice);
                if(this.m === 'iso') {
                    document.getElementById('quest-title').innerText = d.q;
                    this.draw(d);
                    this.renderOptions(d.opts);
                } else if(this.m === 'tipos') {
                    document.getElementById('quest-title').innerText = "¬øGrado del carbono marcado?";
                    this.drawTipos(this.i);
                    this.renderOptions(["Primario", "Secundario", "Terciario", "Cuaternario"]);
                } else {
                    document.getElementById('quest-title').innerText = "Nombre IUPAC:";
                    this.draw(d);
                }
            },
            renderOptions(opts) {
                const box = document.getElementById('ui-options-box');
                box.innerHTML = '';
                opts.forEach(o => {
                    const btn = document.createElement('button');
                    btn.className = "btn-option";
                    btn.style.padding = "15px";
                    btn.innerText = o;
                    btn.onclick = () => this.validate(o);
                    box.appendChild(btn);
                });
            },
            draw(d) {
                const ns = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(ns, "svg");
                svg.setAttribute("viewBox", "0 0 450 250");
                svg.style.width = "95%";
                const p = document.createElementNS(ns, "path");
                p.setAttribute("d", d.svg); p.setAttribute("stroke", "white");
                p.setAttribute("stroke-width", "5"); p.setAttribute("fill", "none");
                p.setAttribute("stroke-linecap", "round");
                svg.appendChild(p);
                if(d.type === "doble") {
                    const t1 = document.createElementNS(ns, "path");
                    t1.setAttribute("d", "M60,102 L100,102"); t1.setAttribute("stroke", "white"); t1.setAttribute("stroke-width", "2");
                    svg.appendChild(t1);
                }
                document.getElementById('canvas').appendChild(svg);
            },
            drawTipos(idx) {
                const layouts = [
                    {s:"M50,150 L100,110 L150,150 L200,110", t:[50,150], a:"Primario"},
                    {s:"M50,150 L100,110 L150,150 L200,110", t:[100,110], a:"Secundario"},
                    {s:"M50,150 L100,110 L150,150 L200,110 M150,150 L150,200", t:[150,150], a:"Terciario"},
                    {s:"M100,110 L150,110 L200,110 M150,110 L150,60 M150,110 L150,160", t:[150,110], a:"Cuaternario"}
                ];
                const d = layouts[idx % 4];
                const ns = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(ns, "svg");
                svg.setAttribute("viewBox", "0 0 400 250"); svg.style.width = "85%";
                const p = document.createElementNS(ns, "path");
                p.setAttribute("d", d.s); p.setAttribute("stroke", "white"); p.setAttribute("stroke-width", "6"); p.setAttribute("fill", "none");
                svg.appendChild(p);
                const c = document.createElementNS(ns, "circle");
                c.setAttribute("cx", d.t[0]); c.setAttribute("cy", d.t[1]); c.setAttribute("r", "12"); c.setAttribute("fill", "var(--accent)");
                svg.appendChild(c);
                document.getElementById('canvas').appendChild(svg);
            },
            check() {
                const user = document.getElementById('ans-in').value.toLowerCase().trim().replace(/\s+/g, '');
                const currentData = DB[this.m][this.i % DB[this.m].length];
                const corrects = currentData.ans.map(x => x.toLowerCase().replace(/\s+/g, ''));
                this.validate(corrects.includes(user) ? currentData.ans[0] : 'err');
            },
            validate(val) {
                const ok = (this.m === 'nomen') ? val !== 'err' : val === DB[this.m][this.i % DB[this.m].length].ans;
                if(ok) { this.s += 100; this.i++; this.load(); }
                else { this.v--; if(this.v <= 0) this.end(false); this.upd(); }
            },
            hint() { 
                const d = DB[this.m][this.i % DB[this.m].length];
                if(this.s >= 20) { this.s -= 20; alert(d.hint); this.upd(); } 
            },
            upd() {
                document.getElementById('v-val').innerText = this.v;
                document.getElementById('s-val').innerText = this.s;
                document.getElementById('l-val').innerText = `${this.i + 1}/20`;
            },
            end(win) {
                document.getElementById('sc-game').classList.add('hidden');
                document.getElementById('sc-end').classList.remove('hidden');
                document.getElementById('feedback').innerText = win ? "¬°Impresionante! Eres un maestro de la qu√≠mica org√°nica." : "Casi lo logras. Revisa tus apuntes y vuelve a intentar.";
                document.getElementById('final-score').innerText = this.s;
            }
        };
    </script>
</body>
</html>

</html>
